#!/bin/bash

cd ~/projects/moose
git submodule deinit libmesh/ -f
JOBS=4 ./scripts/update_and_rebuild_libmesh.sh

cd test
make cleanall
make clobberall
make -j4

if [ "$1" != "--no-test" ]; then
  ./run_tests -j4 -p2
fi

cd ../modules
make clean
make -j4

if [ "$1" != "--no-test" ]; then
  ./run_tests -j4 -p2
fi
